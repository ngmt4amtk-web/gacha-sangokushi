:root {
  --bg1: #0f0f1a; --bg2: #1a1a2e; --bg3: #16213e;
  --gold: #ffd700; --silver: #c0c0c0;
  --n: #9e9e9e; --r: #42a5f5; --sr: #ab47bc; --ssr: #ffd700; --ur: #ff4081;
  --shu: #d32f2f; --gi: #1565c0; --go: #2e7d32; --qun: #616161;
  --text: #e0e0e0; --text2: #aaa;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: -apple-system, 'Hiragino Sans', 'Meiryo', sans-serif;
  background: var(--bg1); color: var(--text);
  overflow: hidden; height: 100dvh;
  user-select: none; -webkit-user-select: none;
}
#app {
  max-width: 480px; margin: 0 auto; height: 100dvh;
  display: flex; flex-direction: column;
  background: linear-gradient(180deg, var(--bg2) 0%, var(--bg1) 100%);
}
#topbar {
  padding: 10px 16px; display: flex; justify-content: space-between;
  align-items: center; background: rgba(0,0,0,0.3);
  border-bottom: 1px solid rgba(255,215,0,0.2);
}
.medal-count { font-size: 20px; font-weight: bold; color: var(--gold); text-shadow: 0 0 10px rgba(255,215,0,0.5); }
.medal-rate { font-size: 11px; color: var(--text2); }
.ticket-count { font-size: 16px; font-weight: bold; color: #42a5f5; }
.ticket-label { font-size: 10px; color: var(--text2); }
.chapter-info { font-size: 13px; color: var(--text2); text-align: right; }
.chapter-num { font-size: 14px; font-weight: bold; color: #fff; }
#screens { flex: 1; overflow-y: auto; overflow-x: hidden; position: relative; }
.screen { display: none; padding: 16px; min-height: 100%; }
.screen.active { display: block; }
#bottomnav { display: flex; background: rgba(0,0,0,0.5); border-top: 1px solid rgba(255,255,255,0.1); }
.nav-btn {
  flex: 1; padding: 8px 0; text-align: center; border: none;
  background: transparent; color: var(--text2); font-size: 11px;
  cursor: pointer; transition: all 0.2s;
}
.nav-btn.active { color: var(--gold); background: rgba(255,215,0,0.1); }
.nav-btn span { display: block; font-size: 18px; margin-bottom: 2px; }

/* Common */
.section-title {
  font-size: 14px; color: var(--gold); margin: 12px 0 6px;
  border-bottom: 1px solid rgba(255,215,0,0.2); padding-bottom: 4px;
}
.stat-box {
  background: rgba(255,255,255,0.05); border-radius: 8px;
  padding: 12px; margin-bottom: 10px;
}
.stat-row { display: flex; justify-content: space-between; padding: 4px 0; font-size: 13px; }
.stat-label { color: var(--text2); }
.stat-val { font-weight: bold; }
.filter-bar { display: flex; gap: 6px; margin-bottom: 12px; flex-wrap: wrap; }
.filter-btn {
  padding: 6px 12px; border: 1px solid rgba(255,255,255,0.2);
  border-radius: 16px; background: transparent; color: var(--text);
  font-size: 12px; cursor: pointer; transition: all 0.2s;
}
.filter-btn.active { background: rgba(255,215,0,0.2); border-color: var(--gold); color: var(--gold); }

/* Modal */
.modal-overlay {
  position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.85); z-index: 100;
  display: none; align-items: center; justify-content: center;
}
.modal-overlay.show { display: flex; }
.modal-content {
  background: var(--bg2); border-radius: 16px; padding: 24px;
  max-width: 400px; width: 92%; max-height: 85vh; overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.1);
}
.modal-close {
  float: right; background: none; border: none; color: var(--text);
  font-size: 24px; cursor: pointer;
}

/* Particles */
#particles {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  pointer-events: none; z-index: 350;
}

/* Scrollbar */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 2px; }

/* Animations */
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.6; } }
@keyframes slideUp {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
@keyframes rainbow {
  0% { border-color: #ff0000; } 17% { border-color: #ff8800; }
  33% { border-color: #ffff00; } 50% { border-color: #00ff00; }
  67% { border-color: #0088ff; } 83% { border-color: #8800ff; }
  100% { border-color: #ff0000; }
}
.rainbow-border { animation: rainbow 1s linear infinite; }
